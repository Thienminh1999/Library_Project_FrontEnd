<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Member Managemet</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

    <link rel="stylesheet" type="text/css" th:href="@{../css/style.css}" />
  <link rel="stylesheet" type="text/css" href="../css/all.min.css" />
  <link rel="stylesheet" type="text/css" href="../css/fontawesome.min.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
    <script>
        function getItemFromListSubCate() {
            var values = $('#listSubCate').val();
            document.getElementById('listSubCateHidden').value = values;
        }

        $('.datepicker').datepicker();
        

    </script>

</head>

<body>
    <input type="checkbox" id="nav-toggle" />
    <div th:replace="sidebar :: navbar">
    </div>

    <div class="main-content">
        <div th:replace="header :: header"></div>

        <main>
            <div class="mess-progress" th:if="${mess} != null">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                Add a book success!
            </div>
            <div class="mess-progress" th:if="${messUpdate} != null">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                Update book success!
            </div>
            <div class="border-right">
                <form th:action="@{/addBook}" th:object="${bookinfo}" method="post" class="width-100">
                    <h2 th:if="${update} != true">Add new book</h2>
                    <h2 th:if="${update} == true">Update a book</h2>
                    <hr />

                    <div class="add-group">
                        <input type="hidden" th:field="*{bookID}">
                        <label> BookName: </label>
                        <input type="text" autocomplete="off" class="add-info-book" th:field="*{bookName}" />
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getBookNameError()}"></span>
                        </div>
                    </div>

                    <div class="add-group" th:if="${update} != true">
                        <label> Publisher: </label>
                        <input type="text" class="add-info-book" th:field="*{publisher}" />
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getPublisherError()}"></span>
                        </div>
                    </div>

                    <div class="add-group" th:if="${update} != true">
                        <label> PublishDate: </label>
                        <input type="date" class="add-info-book" th:field="*{publishDate}" />
                        <div class="error-form" th:if="${errorForm != null}" >
                            <span th:text="${errorForm.getPublishDateError()}"></span>
                        </div>
                    </div>

                    <div class="add-group">
                        <label> Quantity: </label>
                        <input type="number" class="add-info-book" th:field="*{quantity}" min="0" onkeyup="if(this.value<0){this.value= this.value * -1}"/>
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getQuantityError()}"></span>
                        </div>
                    </div>

                    <div class="add-group">
                        <label> Description: </label>
                        <textarea class="add-info-book" th:field="*{description}"></textarea>
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getDescriptionError()}"></span>
                        </div>
                    </div>

                    <div class="add-group">
                        <label> BookPosition: </label>
                        <input type="text" class="add-info-book" th:field="*{bookPosition}" />
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getBookPositionError()}"></span>
                        </div>
                    </div>

                    <div class="add-group" th:if="${update} != true">
                        <label> MainCatagory: </label>
                        <select class="mul-select" th:field="*{categoryID}">
                            <option th:each="item : ${MainCateList}" th:value="${item.getCategoryID()}"
                                th:text="${item.getCategoryName()}"></option>
                        </select>
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getMainCategoryError()}"></span>
                        </div>
                    </div>

                    <div class="add-group" th:if="${update} != true">
                        <label> Author: </label>
                        <select class="mul-select" th:field="*{authorID}">
                            <option th:each="item : ${listAuthor}" th:value="${item.getAuthorID}"
                                th:text="${item.getAuthorName}"></option>
                        </select>
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getMainCategoryError()}"></span>
                        </div>
                    </div>


                    <div class="add-group" th:if="${update} != true">
                        <label> SubCatagory: </label>
                        <input type="hidden" name="listSubCateHidden" id="listSubCateHidden">
                        <select class="mul-select" multiple="true" id="listSubCate" onchange="getItemFromListSubCate()">
                            <option th:each="item : ${SubCateList}" th:value="${item.getSubCategoryID()}"
                                th:text="${item.getSubCategoryName()}"></option>
                        </select>
                        <div class="error-form" th:if="${errorForm != null}">
                            <span th:text="${errorForm.getSubCategoryError()}"></span>
                        </div>
                    </div>

                    <div class="add-book-btn">
                        <button type="submit" th:if="${update} != true" name="btnSaveUpdate" th:value="add">Add</button>
                        <button type="submit" th:if="${update} == true" name="btnSaveUpdate"  th:value="update">Update</button>
                        <a th:if="${update} != true" th:href="@{/createBookPage}"><span>Clean</span></a>
                    </div>

                </form>
            </div>
            <div class="qr-card" th:if="${img} != null">
                <div>
                    <img th:src="${img}" width="200" height="200">
                </div>
                <div class="btn-print-qr add-book-btn">
                    <button disabled="true">print</button>
                </div>
            </div>
        </main>

        <div th:replace="footer :: footer"></div>
    </div>
    </div>
</body>

</html>